                             Overview

I. Overview of Program Files and Directories

   The pipeline programs are in crispr-dav directory.  

      crispr.pl   : The program to initiate the pipeline. 
      run.sh      : A template shell script to run crispr.pl. Modify before use.  
      sample.pl   : Invokeby crispr.pl to process a sample.
      cxdata.pl   : Invoked by sample.pl to generate data for canvasXpress.
      crispr2cx.pl: Invoked by crispr.pl to generate visual alignment view.
      report.pl   : Invoked by crispr.pl to generate HTML report of CRISPR results.
      overlap.pl  : An independent program to assess what percentages of 
                    overlapping paired-end reads agree and disagree.

      Assets      : Directory containing HTML images, css, and javascripts.
      BMS         : Directory containing Perl modules used by crispr2cx.pl. 
      Doc         : Directory containing this document, install instructions, etc.    
      Modules     : Directory containing Perl modules used by other perl programs.
      Rscripts    : Directory containing R scripts used by the pipeline. 
      Examples    : Directory containing two sets of example data. 
                    example1: uses standard genome as reference.
                    example2: uses a custom sequence as reference.


II. Overview of Input and Output Data Files 

1. The analysis pipeline accepts input and output in relative and/or absolute paths. 
   By default, output is produced in the current directory.

2. Input files:

   The input files are accepted by the pipeline program crispr.pl. For detailed
   requirement of each input file, please run: crispr.pl -h. Here is an overview. 

   The names and paths of these files can be changed.

   (1) conf.txt: describes the locations of genome, tools, and parameters.

   (2) amplicon.bed: the bed file for amplicon, containing 6 tab-separated fields.
          Only one region is allowed in the file. If an experiment has two amplicons,
          each amplicon needs to be analyzed in its own pipeline run.

   (3) site.bed: the bed file for CRISPR sites. Each site has 6 or 7 tab-separated
          fields. Each site has its own row in the file. 

   (4) sample.site: A file that lists sample name, and one or more CRISPR guide 
          sequences the sample has been treated with..

   (5) fastq.list: A file that lists sample name, forward read fastq file path, and 
          optionally reverse read fastq file path. 
 
   (6) fastq files: the actual fastq files that were listed in fastq.list. They must
          be gzipped and have .gz extension. 

   (7) genome files: these include genome fasta file and bwa index files. Their paths
          are to be stored in conf.txt.

   (8) run.sh: a template script to start the pipeline. Modify it according to
          the actual input file paths. 

   (9) amp.fa: this is a custom fasta file. It's used in lieu of standard genome, as  
          in example2 of the pipeline package. There can be only one sequence in the 
          fasta file. The sequence ID must match the first column in site.bed. And 
          there is no need to have a genome section in conf.txt.

3. Output files: 
    
   Output files are stored in two subdirectories of the output directory.

   (1) align. This directory contains intermediate files. These include:

       .fastq.gz     Filtereed fastq file
       .bam          Alignment bam file	
       .fliter.log   Filtering log
       .bwa.log      BWA alignment log
       .abra.log     ABRA realignment log if realign_flag is set to Y in conf.txt
       <sample>.log  General log for sample processing 
       .chr          Counts of reads mapped on different chromosomes 
       .cnt          Counts of reads at different stages of pre-processing
       .can          File for generating CanvasXpress alignment view
       .hdr          File for generating Homology Directed Repair plot
       .len          Contains read counts for WT and indels of various lengths  
       .pct          Contains summary read stats of WT and indel
       .snp          Contains mutation stats generated by pysamstats around CRISPR site
       .tgt          Contains sequence in sgRNA region in each read spanning
                        this region. Indel start and end locations are indicated.
                        Indel location can extend outside the region. Read ID and 
                        strand are also shown.
       .hdr.bed      Coordinates of HDR region
       .hdr.seq      Similar to .tgt but the sequence region is in HDR region
       .var          Contains mutation stats generated by pysamstats in amplicon
       .done         Signal file generated when processing of a sample succeeds 
       .failed       Signal file generated when processing of a sample fails
       tmp           Directory containing temporary files generated by ABRA.
       <name>.*.txt  Combined data of various type of all samples in a CRISPR site.

       The 'align' directory is not required after the HTML report is produdced. 

   (2) deliverables. This directory contains one or more subdirectories
       depending on number of CRISPR sites in site.bed. The subdirectory
       contains the HTML report and its component files. 

III. Installation

   For installation instructions, see Installation.txt. 
